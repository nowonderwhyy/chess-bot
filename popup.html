<!doctype html>
<html>
    <head>
        <title>Chess.com Analysis</title>
        <link rel="stylesheet" href="./popup.css">
    </head>
    <body>
        <div class="container">
        <div class="current">
            <div class="row wrap">
                <div class="col subtle">Current</div>
                <div class="right kpi">
                    <div>Depth <b id="current-depth">0</b></div>
                    <div>NPS <b id="current-nps">0</b><span id="current-tb"></span></div>
                </div>
            </div>
            <div class="row wrap">
                <div class="col">Level <b id="current-level">8</b> (<span id="current-level-elo">~2250 Elo</span>)</div>
                <div class="right">Think <b id="current-mode">0.2s</b>, PVs <b id="current-multipv">1</b></div>
            </div>
        </div>
        <div class="card">
            <div class="header"><div class="title">Play strength</div></div>
            <div class="row">
                <div class="col subtle">Level <span id="level-slider-value">8</span> (0–20) — <span id="level-elo">~2250 Elo</span></div>
                <button id="set-level" class="right">Apply</button>
            </div>
            <input type="range" min="0" max="20" step="1" id="level-slider" value="8" />
            <div class="hint">Use Elo limit for realistic strength; otherwise engine uses maximum skill.</div>
        </div>
        <div class="card">
          <div class="header"><div class="title">Lines & overlay</div></div>
          <div class="row">
            <div class="col subtle">Top <span id="multipv-slider-value">1</span> line(s) (1–5)</div>
            <button id="set-multipv" class="right">Apply</button>
          </div>
          <input type="range" min="1" max="5" step="1" id="multipv-slider" value="1" />
          <label class="hint"><input type="checkbox" id="minimal-overlay-checkbox"/> Minimal overlay (PV1 only)</label>
          <div class="hint">More lines reduce strength. Keep 1 for play, 2–3 for analysis.</div>
        </div>
        <div class="card">
          <div class="header"><div class="title">Elo limit</div></div>
          <label><input type="checkbox" id="elo-enabled"/> Limit strength by Elo</label>
          <div class="row">
              <input type="number" id="elo-value" min="1320" max="3190" step="50" value="1600"/>
              <button id="set-elo" class="right">Apply</button>
          </div>
          <div class="hint">When on, Skill Level is ignored; Stockfish emulates the selected Elo.</div>
        </div>
        <div class="card">
          <div class="header"><div class="title">Engine memory</div></div>
          <div class="row">
            <div class="col subtle">Hash <b id="hash-slider-value">64</b> MB</div>
            <button id="set-hash" class="right">Apply</button>
          </div>
          <input type="range" min="16" max="256" step="16" id="hash-slider" value="64" />
        </div>
        <div class="card">
          <div class="header"><div class="title">Threads</div></div>
          <div class="row">
            <div class="col subtle">Using <b id="threads-slider-value">1</b> thread(s)</div>
            <button id="set-threads" class="right">Apply</button>
          </div>
          <input type="range" min="1" max="32" step="1" id="threads-slider" value="1" />
        </div>
        <div class="card">
          <div class="header"><div class="title">Engine time usage</div></div>
          <div class="row">
            <label style="margin-right:12px"><input type="radio" name="time-mode" id="time-mode-fixed" value="fixed"/> Fixed — <b><span id="time-slider-value">0.2</span></b>s per move</label>
            <button id="set-time" class="right">Apply</button>
          </div>
          <input type="range" min="200" max="5000" step="100" id="time-slider" value="200" />
          <div class="row" style="margin-top:8px">
            <label><input type="radio" name="time-mode" id="time-mode-adaptive" value="adaptive"/> Adaptive — use game clock</label>
          </div>
          <div class="row" style="margin-top:6px">
            <div class="col subtle">Move Overhead <b id="overhead-slider-value">80</b>ms</div>
            <div class="right subtle">Slow Mover <b id="slowmover-slider-value">100</b>%</div>
          </div>
          <input type="range" min="0" max="5000" step="10" id="overhead-slider" value="80" />
          <input type="range" min="10" max="1000" step="10" id="slowmover-slider" value="100" />
          <button id="apply-time-mgmt" class="secondary">Apply</button>
          <div class="hint">In Adaptive mode, Stockfish manages the clock; Overhead and Slow Mover apply. In Fixed mode, a constant per‑move time is used.</div>
        </div>
        <details class="card">
          <summary><span class="chev">▶</span> Calibration</summary>
          <div class="hint" style="margin:6px 0">Run a quick benchmark to sanity‑check performance and get a Hash suggestion.</div>
          <button id="run-calibrate" class="secondary">Run speed test</button>
          <pre id="calibration-output" style="max-height: 120px; overflow: auto; background:#0f1320; color:#9fb4ff; padding:6px; border-radius:8px; white-space: pre-wrap; border:1px solid #283046; margin-top:6px"></pre>
        </details>
        <div class="card">
          <div class="header"><div class="title">Ponder</div></div>
          <label><input type="checkbox" id="ponder-enabled"/> Think during opponent’s turn</label>
        </div>
        
        <details class="card">
          <summary><span class="chev">▶</span> Auto‑move (experimental)</summary>
          <label><input type="checkbox" id="auto-move-checkbox"/> Play best move automatically</label>
          <div class="row">
            <div class="col subtle">Confidence gate <b id="auto-confidence-value">0</b>%</div>
          </div>
          <input type="range" min="0" max="20" step="1" id="auto-confidence-slider" value="0" />
          <div class="row">
            <div class="col subtle">Base delay <b id="auto-delay-base-value">150</b>ms · Random ±<b id="auto-delay-jitter-value">600</b>ms</div>
          </div>
          <input type="range" min="0" max="1500" step="50" id="auto-delay-base-slider" value="150" />
          <input type="range" min="0" max="20000" step="100" id="auto-delay-jitter-slider" value="600" />
          <div class="hint">Use a small confidence gate (e.g. 1–3%) and a delay to avoid human‑obvious instant moves.</div>
        </details>
        </div>
    </body>
    <script src="lib/jquery-3.6.0.min.js"></script>
    <script src="popup.js"></script>
</html>